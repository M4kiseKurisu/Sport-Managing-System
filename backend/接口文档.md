# 接口文档

> 该接口文档按照前端功能界面对所有接口进行划分。

[toc]

## 一、用户相关

### 1.1 用户登录验证

请求 URL：`http://127.0.0.1:8000/api/user/login`

请求方式：`GET`

查询参数：

| 参数     | 说明               |
| -------- | ------------------ |
| account  | 账号、string、必需 |
| password | 密码、string、必需 |

```json
{
	"account": "manager",
    "password": "fyb123",
}
```

返回响应：

| 数据      | 说明              |
| --------- | ----------------- |
| msg       | 返回说明、string  |
| status    | 登录状态、boolean |
| uid       | 用户id、int       |
| user_name | 用户名、string    |
| picture   | 头像 url、string  |

```json
{
    "msg": "登录成功",
    "status": true,
    "uid": 2135220,
    "user_name": "贴吧第一美男子",
    "picture": 
}
```



### 1.2 用户注册

请求 URL：`http://127.0.0.1:8000/api/user/register`

请求方式：`POST`

请求参数（application/json）：

| 参数         | 说明                                  |
| ------------ | ------------------------------------- |
| account      | 账号、string、必选                    |
| password     | 密码、string、必选                    |
| user_name    | 用户名、string、必选                  |
| user_age     | 用户年龄、string、必选                |
| user_gender  | 用户性别、int、必选、0表示女，1表示男 |
| phone_number | 电话号码、int、必选                   |
| email        | 邮箱、string、必选                    |

```json
{
    "account": "manager",
    "password": "fyb123",
    "user_name": "贴吧第一美男子",
    "user_age": 10,
    "user_gender": 0,
    "phone_number": 12345678910,
    "email": "sb@outlook.com"
}
```

返回响应：

| 数据      | 说明              |
| --------- | ----------------- |
| msg       | 返回说明、string  |
| status    | 请求状态、boolean |
| uid       | 用户id、int       |
| user_name | 用户名、string    |

```json
{
    "msg": "注册成功",
    "status": true,
    "uid": 2135220,
    "user_name": "贴吧第一美男子"
}
```



### 1.3 查看个人基本信息

>说明：查看指定用户的基本信息。
>
>保证：用户的 uid 在数据库中。

请求 URL：`http://127.0.0.1:8000/api/user/information`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |

```json
{
    "uid":  2135220
}
```

返回响应：

| 数据   | 说明                 |
| ------ | -------------------- |
| msg    | 返回说明、string     |
| status | 请求状态、boolean    |
| info   | 用户信息对象、object |

```json
{
    "msg": "个人基本信息获取成功",
    "status": true,
    "info": {
        "uid": "2135220",
        "name": "贴吧第一美男子",
        "age": 10,
        "gender": "女",
        "phone": 12345678910,
        "email": "sb@outlook.com",
        "signature": "抽象",
        "picture": null,
        "activity": 0,
        "friend": 0,
        "group": 2
    }
}
```



### 1.4 修改个人信息

>说明：用户修改个人基本信息。
>
>保证：用户的 uid 在数据库中。
>
>错误：修改后的电话号码和邮箱重复。

请求 URL：`http://127.0.0.1:8000/api/user/modify/text`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明                         |
| ---- | ---------------------------- |
| uid  | 用户id、int、必选            |
| data | 修改的信息对象、object、必选 |

data 是一个对象，其中包括修改的个人信息。

data 有如下属性**可选**（严格以此命名属性名）：

|     属性名     |           说明           |
| :------------: | :----------------------: |
|   user_name    |   用户名、string、可选   |
|    user_age    |     年龄、int、可选      |
|  user_gender   | 性别、int (0女1男)、可选 |
|  phone_number  |   电话号码、int、可选    |
|     email      |    邮箱、string、可选    |
| user_signature |  个人签名、string、可选  |

```json
{
    "uid": 2135220,
    "data": {
        "user_age": 19,
        "user_gender": 1,
        "user_signature": "汪汪汪！"
    }
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "个人信息修改成功",
    "status": true
}
```



### 1.5 上传个人头像

> 说明：用户更改个人头像。
>
> 保证：用户 uid 在数据库中。

请求 URL：`http://127.0.0.1:8000/api/user/modify/pic`

请求方式：`POST`

请求参数（multipart/form-data）：

| 参数    | 说明                 |
| ------- | -------------------- |
| uid     | 用户id、int、必选    |
| picture | 头像图片、file、必选 |

```js
var data = new FormData();
data.append('uid', '2135220');
data.append('picture', file;
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "头像已更新",
    "status": true
}
```



### 1.6 查看用户所属团体

> 说明：查看指定用户所属的团体信息。
>
> 保证：用户的 uid 在数据库中。

请求 URL：`http://127.0.0.1:8000/api/user/group`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |

```json
{
    "uid": 2135220
}
```

返回响应：

| 数据   | 说明                |
| ------ | ------------------- |
| msg    | 返回说明、string    |
| status | 请求状态、boolean   |
| list   | 团体信息数组、array |

```json
{
    "msg": "团体信息请求成功",
    "status": true,
    "list": [
        {
            "gid": 24103669,
            "group_name": "大运村",
            "group_desc": "代孕村崛起",
            "tag": "综合",
            "capacity": 2,
            "maximum": 1000,
            "creator": "贴吧第一美男子",
            "pic": "/media/images/group/20231120155452_75.jpg",
            "type": "创建人"
        },
        {
            "gid": 63227680,
            "group_name": "buaa",
            "group_desc": "世界第一大专",
            "tag": "综合",
            "capacity": 2,
            "maximum": 50,
            "creator": "贴吧第一美男子",
            "pic": null,
            "type": "创建人"
        }
    ]
}
```



### 1.7 查看用户参加的活动

请求 URL：`http://127.0.0.1:8000/api/user/activity/view`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |

```json
{
    "uid": 2135220
}
```

返回响应：

| 数据   | 说明                |
| ------ | ------------------- |
| msg    | 返回说明、string    |
| status | 请求状态、boolean   |
| list   | 活动信息数组、array |

```json
{
    "msg": "活动信息获取成功",
    "status": true,
    "list": [
        {
            "aid": 1429664,
            "name": "夜跑团建",
            "type": "团体",
            "private": true,
            "category": "跑步",
            "capacity": 1,
            "maximum": 25,
            "picture": "/media/images/activity/20231130172210_80.jpg",
            "start_time": "2024-01-01 20:30:00",
            "end_time": "2024-01-01 21:40:00",
            "favor": 0,
            "is_favor": false
        },
        {
            "aid": 44709897,
            "name": "RAOS 发布会",
            "type": "个人",
            "private": false,
            "category": "篮球",
            "capacity": 3,
            "maximum": 500,
            "picture": "/media/images/activity/20231127190029_59.jpg",
            "start_time": "2023-10-30 15:00:00",
            "end_time": "2023-10-30 18:00:00",
            "favor": 0,
            "is_favor": false
        }
    ]
}
```



### 1.8 统计用户活动

> 说明：统计用户参加的活动，按照运动类型进行统计。
>
> 保证：用户实体存在。

请求 URL：`http://127.0.0.1:8000/api/user/activity/statistic`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |

```json
{
    "uid": 2135220
}
```

返回响应：

| 数据   | 说明                 |
| ------ | -------------------- |
| msg    | 返回说明、string     |
| status | 请求状态、boolean    |
| data   | 统计信息对象、object |

```json
{
    "msg": "活动统计信息获取成功",
    "status": true,
    "data": {
        "跑步": 1,
        "篮球": 1
    }
}
```

<br>

## 二、团体相关

### 2.1 团体中心综述

> 说明：团体中心列表，可以通过团体名、团体描述、团体标签关键字来搜索。
>
> 保证：相关实体在数据库中。

请求 URL：`http://127.0.0.1:8000/api/group/view`

请求方式：`GET`

查询参数：

| 参数    | 说明                 |
| ------- | -------------------- |
| keyword | 关键字、string、可选 |
| uid     | 用户id、int、必选    |

```json
{
    "uid": 2135220,
    "keyword": "B"
}
```

返回响应：

| 数据   | 说明                |
| ------ | ------------------- |
| msg    | 返回说明、string    |
| status | 请求状态、boolean   |
| list   | 团体信息数组、array |

```json
{
    "msg": "团体信息请求成功",
    "status": true,
    "list": [
        {
            "gid": 63227680,
            "group_name": "buaa",
            "group_desc": "世界第一大专",
            "tag": "综合",
            "capacity": 1,
            "maximum": 50,
            "creator": "贴吧第一美男子",
            "is_joined": true,
            "pic": null
        }
    ]
}
```



### 2.2 用户创建团体

> 说明：用户创建团体。
>
> 保证：用户 uid 已经注册到数据库中。
>
> 错误：团体名称已经存在。

请求 URL：`http://127.0.0.1:8000/api/group/create`

请求方式：`POST`

请求参数（multipart/form-data）：

| 参数       | 说明                   |
| ---------- | ---------------------- |
| uid        | 用户id、int、必选      |
| group_name | 团体名、string、必选   |
| group_desc | 团体描述、string、必选 |
| maximum    | 人数上限、int、必选    |
| tag        | 团体标签、string、必选 |
| picture    | 团体图片、file、必选   |

```js
let data = new FormData();
data.append('uid', '2135220');
data.append('group_name', '大运村');
data.append('group_desc', '代孕村崛起');
data.append('maximum', '1000');
data.append('tag', '综合');
data.append('picture', xxx);
```

返回响应：

| 数据       | 说明              |
| ---------- | ----------------- |
| msg        | 返回说明、string  |
| status     | 请求状态、boolean |
| group_name | 团体名、string    |
| gid        | 团体id、int       |

```json
{
    "msg": "团体创建成功",
    "status": true,
    "group_name": "大运村",
    "gid": 24103669
}
```



### 2.3 用户申请加入团体

> 说明：用户申请加入指定团体。
>
> 保证：用户、团体均已经存在于数据库中；用户尚未加入到团体中。
>
> 错误：审核时段申请则失败，团体人数已到达上限时失败。

请求 URL：`http://127.0.0.1:8000/api/group/join`

请求方式：`POST`

请求参数（application/json）：

| 参数    | 说明                   |
| ------- | ---------------------- |
| uid     | 用户id、int、必选      |
| gid     | 团体id、int、必选      |
| content | 申请信息、string、必选 |

```json
{
    "uid": 30359251,
    "gid": 63227680,
    "content": "我要上摆航"
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 申请状态、boolean |

```json
{
    "msg": "申请信息已发送",
    "status": true
}
```



### 2.4 查看团体申请信息

> 说明：团体创建人、管理员查看团体的申请信息、用户查看已发送的团体申请信息。
>
> 保证：用户存在于数据库中

请求 URL：`http://127.0.0.1:8000/api/group/apply`

请求方式：`GET`

查询参数：

| 参数   | 说明                   |
| ------ | ---------------------- |
| uid    | 用户id、int、必选      |
| method | 申请类型、string、必选 |

method参数有两个选项：accept、send，分别表示查看收到团体申请和个人发送的团体申请。

```json
{
    "uid": 2135220,
    "method": "accept"
}

{
    "uid": 30359251,
    "method": "send"
}
```

返回响应：

| 数据 | 说明                |
| ---- | ------------------- |
| msg  | 返回说明、string    |
| list | 申请信息数组、array |

```json
/* method: accept */
{
  "msg": "团体申请获取成功",
  "status": true,
  "list": [
    {
      "uid": 30359251,
      "user_name": "小二",
      "content": "我要上摆航",
      "gid": 63227680,
      "group_name": "buaa",
      "time": "2023-11-20 17:02:08",
      "status": "申请中"
    }
  ]
}

/* method: send */
{
    "msg": "团体申请获取成功",
    "status": true,
    "list": [
        {
            "gid": 63227680,
            "group_name": "buaa",
            "content": "我要上摆航",
            "time": "2023-11-20 17:02:08",
            "status": "申请中"
        }
    ]
}
```



### 2.5 处理团体申请信息

> 说明：团体的管理员或创建人可以审批处理团体的申请。
>
> 保证：相关实体存在于数据库中，保证申请信息存在。
>
> 错误：团体人数已达上限时，同意申请出错。

请求 URL：`http://127.0.0.1:8000/api/group/apply`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明                                             |
| ---- | ------------------------------------------------ |
| uid  | 申请人id、int、必选                              |
| gid  | 团体id、int、必选                                |
| res  | 是否同意、boolean、必选、`true`同意，`false`拒绝 |

```json
{
    "uid": 30359251,
    "gid": 63227680,
    "res": true
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "处理完成",
    "status": true
}
```



### 2.6 查看团体成员

> 说明：查看团体中的所有成员。
>
> 保证：相关实体存在于数据库中。
>

请求 URL：`http://127.0.0.1:8000/api/group/members/list`

请求方式：`GET`

查询参数：

| 参数    | 说明                       |
| ------- | -------------------------- |
| gid     | 团体id、int、必选          |
| keyword | 成员名关键字、string、可选 |

```json
{
    "gid": 63227680,
    "keyword": ""
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |
| list   | 成员列表、array  |

```json
{
    "msg": "成员列表获取成功",
    "status": true,
    "list": [
        {
            "uid": 2135220,
            "user_name": "贴吧第一美男子",
            "pic": "/media/images/user/20231123220048_15.jpg",
            "type": "创建人"
        },
        {
            "uid": 30359251,
            "user_name": "小二",
            "pic": "/media/images/user/20231123220048_15.jpg",
            "type": "成员"
        }
    ]
}
```



### 2.7 移除成员

> 说明：团体创建人可以移除除自己以外的所有成员，团体管理员可以移除普通成员。
>
> 保证：严格按照上述权限，并且不可以移除自己。

请求 URL：`http://127.0.0.1:8000/api/group/members/remove`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 成员id、int、必选 |
| gid  | 团体id、int、必选 |

```json
{
    "uid": 30359251,
    "gid": 63227680
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "成员已移除",
    "status": true
}
```



### 2.8 用户退出团体

> 说明：团体成员退出团体，其中创建者退出意味着解散团体。
>
> 保证：相关实体和联系存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/group/exit`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 成员id、int、必选 |
| gid  | 团体id、int、必选 |

```json
{
    "uid": 2135220,
    "gid": 63227680
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "团体已退出",
    "status": true
}
```



### 2.9 修改管理员权限

> 说明：团体创建人可以添加或移除成员的管理员权限。
>
> 保证：相关实体存在于数据库中，不做重复操作(管理员变成管理员、普通成员变为普通成员)。

请求 URL：`http://127.0.0.1:8000/api/group/members/authority`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明                                      |
| ---- | ----------------------------------------- |
| uid  | 成员id、int、必选                         |
| gid  | 团体id、int、必选                         |
| type | 成员权限、int、必选（1管理员，2普通成员） |

```json
{
    "uid": 30359251,
    "gid": 24103669,
    "type": 1
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "添加团体管理员成功",
    "status": true
}
```



### 2.10 查看团体创建活动

> 说明：查看指定团体创建的活动。
>
> 保证：团体实体存在。

请求 URL：`http://127.0.0.1:8000/api/user/activity/view`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| gid  | 团体id、int、必选 |

```json
{
    "gid": 36701662
}
```

返回响应：

| 数据   | 说明                |
| ------ | ------------------- |
| msg    | 返回说明、string    |
| status | 请求状态、boolean   |
| list   | 活动信息数组、array |

```json
{
      "msg": "活动信息获取成功",
      "status": true,
      "list": [
            {
                  "aid": 1429664,
                  "name": "夜跑团建",
                  "type": "团体",
                  "private": true,
                  "category": "跑步",
                  "capacity": 1,
                  "maximum": 25,
                  "picture": "/media/images/activity/20231130172210_80.jpg",
                  "start_time": "2024-01-01 20:30:00",
                  "end_time": "2024-01-01 21:40:00",
                  "favor": 0
            }
      ]
}
```



### 2.11 统计团体活动

> 说明：团体历史创建活动的统计信息。
>
> 保证：团体实体存在。

请求 URL：`http://127.0.0.1:8000/api/group/activity/statistic`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| gid  | 团体id、int、必选 |

```json
{
    "gid": 36701662
}
```

返回响应：

| 数据   | 说明                 |
| ------ | -------------------- |
| msg    | 返回说明、string     |
| status | 请求状态、boolean    |
| data   | 统计信息对象、object |

```json
{
      "msg": "活动统计信息获取成功",
      "status": true,
      "data": {
            "跑步": 1
      }
}
```

<br>

## 三、场地相关

### 3.1 新增场地信息

请求 URL：`http://127.0.0.1:8000/api/field/add`

请求方式：`POST`

请求参数（application/json）：

| 参数       | 说明                    |
| ---------- | ----------------------- |
| category   | 类别、string、必选      |
| location   | 位置、string、必选      |
| limit      | 场地限制、boolean、必选 |
| open_time  | 开始时间、time、必选    |
| close_time | 结束时间、time、必选    |

```json
{
    "category": "篮球场",
    "location": "运动场一号篮球场",
    "limit": true,
    "open_time": "06:00",
    "close_time": "22:00"
}
```

返回响应：

| 数据 | 说明             |
| ---- | ---------------- |
| msg  | 返回说明、string |

```json
{
    "msg": "场地信息添加成功"
}
```



### 3.2 查询场地信息

请求 URL：`http://127.0.0.1:8000/api/field/view`

请求方式：`GET`

查询参数：

| 参数     | 说明                   |
| -------- | ---------------------- |
| category | 场地类别、string、可选 |

```json
{
    "category": "篮球场"
}
```

返回响应：

- `category`为空时：

  | 数据 | 说明                  |
  | ---- | --------------------- |
  | msg  | 返回说明、string      |
  | list | 运动场类别数组、array |

  ```json
  {
      "msg": "场地信息请求成功",
      "status": true,
      "list": [
          "篮球场"
      ]
  }
  ```

- `category`非空时：

  | 数据 | 说明                    |
  | ---- | ----------------------- |
  | msg  | 返回说明、string        |
  | list | 场地详细信息数组、array |

  ```json
  {
      "msg": "场地信息请求成功",
      "status": true,
      "list": [
          {
              "fid": 59446556,
              "location": "运动场一号篮球场",
              "open_time": "06:00:00",
              "close_time": "22:00:00"
          }
      ]
  }
  ```



### 3.3 查看场地使用情况

> 说明：查看指定场地指定日期的使用情况。
>
> 保证：场地存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/field/usage`

请求方式：`GET`

查询参数：

| 参数 | 说明                            |
| ---- | ------------------------------- |
| fid  | 场地id、int、必选               |
| time | 时间、string ("%Y-%m-%d“)、必选 |

```json
{
    "fid": 59446556,
    "time": "2023-11-30"
}
```

返回响应：

| 数据   | 说明                          |
| ------ | ----------------------------- |
| msg    | 返回说明、string              |
| status | 请求状态、boolean             |
| list   | 场地被使用的时间段数组、array |

```json
{
    "msg": "场地使用情况获取成功",
    "status": true,
    "list": [
        {
            "start": "15:00:00",
            "end": "18:00:00"
        }
    ]
}
```



<br>

## 四、活动相关

### 4.1 创建活动

> 说明：用户、团体创建人、团体管理员创建新活动。
>
> 保证：相关实体在数据库中、新活动的时间应在当前时间之后(即不应该创建一个过往的活动)、活动的时间必须是一天内的某个时间段。原则上活动最大人数限制至少有一人。
>
> 错误：活动场地在活动时间内已有活动，活动时间不在场地开放时间内。

请求 URL：`http://127.0.0.1:8000/api/activity/create`

请求方式：`POST`

请求参数（multipart/form-data）：

|    参数    |                          类型                          |  说明   | 选择 |
| :--------: | :----------------------------------------------------: | :-----: | :--: |
|    uid     |                         用户id                         |   int   | 必选 |
|    type    |               创建者类型（0个人，1团体）               |   int   | 必选 |
|    gid     |         团体id，**当 type 为 1 时，此项必选**          |   int   | 可选 |
|    name    |                        活动名称                        | string  | 必选 |
|    desc    |                        活动描述                        | string  | 必选 |
|    fid     |                      活动场地 id                       |   int   | 必选 |
|  category  |                     活动的运动类型                     | string  | 必选 |
|    tags    |             活动的标签，用`-`分隔多个标签              | string  | 必选 |
|  maximum   |                    活动最大参与人数                    |   int   | 必选 |
| start_time |             开始时间("%Y-%m-%d %H:%M:%S")              | string  | 必选 |
|  end_time  |             结束时间("%Y-%m-%d %H:%M:%S")              | string  | 必选 |
|  private   | 私有属性（团体活动是否向非团员公开，个人活动是否公开） | boolean | 必选 |
|  picture   |                        团体图片                        |  file   | 必选 |

```js
var data = new FormData();
data.append('uid', '31975929');
data.append('type', '0');
data.append('name', 'RAOS 发布会');
data.append('desc', '这是一款全权由 ryj 开发的比肩甚至超越 linux 的操作系统');
data.append('fid', '59446556');
data.append('category', '篮球');
data.append('tags', '研讨-交流-大型');
data.append('maximum', '500');
data.append('start_time', '2023-11-30 15:00:00');
data.append('end_time', '2023-11-30 18:00:00');
data.append('private', 'false');
data.append('picture', 图片);
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "活动创建成功",
    "status": true
}
```



### 4.2 活动中心热门活动列表

> 说明：用户可以查看当前**对自己可见且尚未开始**的活动。
>
> 保证：保证相关实体存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/activity/view/active`

请求方式：`GET`

查询参数：

| 参数     | 说明                                         |
| -------- | -------------------------------------------- |
| uid      | 用户id、int、必选                            |
| time     | 时间、string ("%Y-%m-%d“)、可选              |
| text     | 活动名，活动描述关键字、string、可选         |
| category | 活动类型、string、可选                       |
| tag      | 活动标签（只支持单个标签）、string、可选     |
| type     | 创建者类型、int（0个人、1团体、2任意）、必选 |

上述可选项用于支持前端用户个性化查找活动。

```json
{
    "uid": 31975929,
    "type": 2
}
```

返回响应：

| 数据   | 说明                    |
| ------ | ----------------------- |
| msg    | 返回说明、string        |
| status | 请求状态、boolean       |
| list   | 活动基本信息数组、array |

```json
{
    "msg": "活动信息获取成功",
    "status": true,
    "list": [
        {
            "aid": 44709897,
            "name": "RAOS 发布会",
            "type": "个人",
            "category": "篮球",
            "capacity": 1,
            "maximum": 500,
            "start_time": "2023-11-30 15:00:00",
            "end_time": "2023-11-30 18:00:00",
            "picture": "/media/images/activity/20231127190029_59.jpg",
            "is_joined": true
        }
    ]
}
```



### 4.3 活动中心往期精彩

> 说明：用户可以查看当前**对自己可见且已经结束**的活动。
>
> 保证：保证相关实体存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/activity/view/inactive`

请求方式：`GET`

查询参数：

| 参数     | 说明                                                     |
| -------- | -------------------------------------------------------- |
| uid      | 用户id、int、必选                                        |
| type     | 创建者类型、int（0个人、1团体、2任意）、必选             |
| method   | 排序方式、string（time时间，favor赞数，scale规模）、必选 |
| time     | 时间、string ("%Y-%m-%d“)、可选                          |
| text     | 活动名，活动描述关键字、string、可选                     |
| category | 活动类型、string、可选                                   |

```json
{
    "uid": 2135220,
    "type": 2,
    "method": "scale"
}
```

返回响应：

| 数据   | 说明                    |
| ------ | ----------------------- |
| msg    | 返回说明、string        |
| status | 请求状态、boolean       |
| list   | 活动基本信息数组、array |

```json
{
    "msg": "活动信息获取成功",
    "status": true,
    "list": [
        {
            "aid": 44709897,
            "name": "RAOS 发布会",
            "type": "个人",
            "category": "篮球",
            "capacity": 1,
            "maximum": 500,
            "start_time": "2023-10-30 15:00:00",
            "end_time": "2023-10-30 18:00:00",
            "picture": "/media/images/activity/20231127190029_59.jpg",
            "favor": 0,
            "is_joined": false
        }
    ]
}
```



### 4.4 查看活动详细信息

>说明：查看指定活动的详细信息内容。
>
>保证：活动存于数据库中。

请求 URL：`http://127.0.0.1:8000/api/activity/detail`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| aid  | 活动id、int、必选 |

```json
{
    "aid": 44709897,
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |
| data   | 活动信息、object  |

data对象中包括如下字段：

| 属性          | 说明                                     |
| ------------- | ---------------------------------------- |
| aid           | 活动id、int                              |
| type          | 创建者类型、string（团体 or 个人）       |
| uid           | 创建用户id、int                          |
| user_name     | 创建用户名、string                       |
| gid           | 创建团体id、int（当且仅当是团体活动）    |
| group_name    | 创建团体名、string（当且仅当是团体活动） |
| activity_name | 活动名、string                           |
| desc          | 活动描述、string                         |
| category      | 运动类型、string                         |
| tags          | 标签数组、array                          |
| capacity      | 活动参与人数、int                        |
| maximum       | 活动最大人数、int                        |
| picture       | 活动图片url、string                      |
| start_time    | 开始时间、string("%Y-%m-%d %H:%M:%S")    |
| end_time      | 结束时间、string("%Y-%m-%d %H:%M:%S")    |
| location      | 活动地点、string                         |
| participants  | 参与者信息、array                        |
| favors        | 喜欢、int                                |

```json
{
    "msg": "活动详细信息获取成功",
    "status": true,
    "data": {
        "aid": 44709897,
        "type": "个人",
        "activity_name": "RAOS 发布会",
        "desc": "这是一款全权由 ryj 开发的比肩甚至超越 linux 的操作系统",
        "category": "篮球",
        "tags": [
            "研讨",
            "交流",
            "大型"
        ],
        "capacity": 1,
        "maximum": 500,
        "picture": "/media/images/activity/20231127190029_59.jpg",
        "start_time": "2023-11-30 15:00:00",
        "end_time": "2023-11-30 18:00:00",
        "location": "运动场一号篮球场",
        "favors": 0,
        "participants": [
            {
                "picture": null,
                "uid": 31975929,
                "user_name": "杰少",
                "gender": 1
            }
        ],
        "uid": 31975929,
        "user_name": "杰少"
    }
}
```



### 4.5 用户加入活动

> 说明：用户加入**尚未加入**的活动。
>
> 保证：相关实体存在；用户只能加入对自己可见的，且尚未开始的活动。
>
> 错误：活动人数已达上限。

请求 URL：`http://127.0.0.1:8000/api/activity/join`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |
| aid  | 活动id、int、必选 |

```json
{
    "uid": 2135220, 
    "aid": 44709897
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
  "msg": "成功加入活动",
  "status": true
}
```



### 4.6 退出/撤销活动

> 说明：用户退出活动、活动负责人撤销活动。
>
> 保证：相关实体和联系存在，只能退出**已参加且未开始**的活动。

请求 URL：`http://127.0.0.1:8000/api/activity/exit`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |
| aid  | 活动id、int、必选 |

```json
{
    "uid": 2135220,
    "aid": 59406561
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "活动已退出",
    "status": true
}
```



### 4.7 点赞/取消点赞活动

> 说明：用户可以给**已参加并且已经结束**的活动点赞或撤销点赞。
>
> 保证：用户只能在没有给活动点赞时点赞，只能在点赞后取消点赞。

请求 URL：`http://127.0.0.1:8000/api/activity/favor`

请求方式：`POST`

请求参数（application/json）：

| 参数   | 说明                                     |
| ------ | ---------------------------------------- |
| uid    | 用户id、int、必选                        |
| aid    | 活动id、int、必选                        |
| method | 方式、string(like点赞，remove取消)、必选 |

```json
{
    "uid": 2135220,
    "aid": 44709897,
    "method": "like"
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
  "msg": "点赞成功",
  "status": true
}
```



### 4.8 活动推荐

> 说明：活动中心主页活动推荐。
>
> 保证：用户实体存在。



<br>

## 五、器材相关

### 5.1 添加器材信息

请求 URL：`http://127.0.0.1:8000/api/equipment/add`

请求方式：`POST`

请求参数（multipart/form-data）：

| 参数     | 说明               |
| -------- | ------------------ |
| category | 类别、string、必选 |
| amount   | 数量、int、必选    |
| picture  | 图片、file、必选   |

```js
let formdata = new FormData();
formdata.append("picture", fileInput.files[0], "basketball.jpg");
formdata.append("category", "篮球");
formdata.append("amount", "20");
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "器材信息添加成功",
    "status": true
}
```



### 5.2 查看器材信息

请求 URL：`http://127.0.0.1:8000/api/equipment/view`

请求方式：`GET`

查询参数：

| 参数    | 说明                         |
| ------- | ---------------------------- |
| keyword | 器材类别关键字、string、可选 |

```json
{
    "keyword": "球"
}
```

返回响应：

| 数据   | 说明                |
| ------ | ------------------- |
| msg    | 返回说明、string    |
| status | 请求状态、boolean   |
| list   | 器材信息数组、array |

  ```json
  {
      "msg": "器材信息请求成功",
      "status": true,
      "list": [
          {
              "eid": 78184649,
              "category": "篮球",
              "amount": 20,
              "pic": "/media/images/equipment/20231118170904_73.png"
          },
          {
              "eid": 95298768,
              "category": "乒乓球",
              "amount": 60,
              "pic": "/media/images/equipment/20231118171341_91.png"
          }
      ]
  }
  ```



### 5.3 借用器材

> 说明：申请借用器材，分为团体借用和个人借用两种。对于团体借用，要求用户必须为该团体的创建人或管理员。
>
> 保证：用户存在、团体存在、借用器材类别存在。
>
> 错误：当借用的数量大于剩余数量时借用失败。同一时段内借用同种器材时借用失败。

请求 URL：`http://127.0.0.1:8000/api/equipment/borrow`

请求方式：`POST`

请求参数（application/json）：

| 参数       | 说明                                            |
| ---------- | ----------------------------------------------- |
| gid        | 团体id、int、可选                               |
| uid        | 用户id、int、可选                               |
| category   | 类别、string、必选                              |
| amount     | 数量、int、必选                                 |
| start_time | 借用开始时间、string("%Y-%m-%d %H:%M:%S")、必选 |
| end_time   | 借用结束时间，string("%Y-%m-%d %H:%M:%S")、必选 |

**gid、uid 参数二选一**，分别表示团体借用器材和用户借用器材两种情况。

```json
{
    "gid": 63227680,
    "category": "排球",
    "amount": 2,
    "start_time": "2023-12-12 13:00:00",
    "end_time": "2023-12-12 15:30:00"
}
```

```json
{
    "uid": 2135220,
    "category": "篮球",
    "amount": 1,
    "start_time": "2023-12-12 19:00:00",
    "end_time": "2023-12-12 20:20:00"
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "器材借用成功",
    "status": true
}
```



### 5.4 查看器材借用记录

> 说明：查看器材借用的记录，共有已归还、未归还两种。对于团体的借用记录，所有成员都可见。
>
> 保证：查询参数中用到的所有实体都存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/equipment/record`

请求方式：`GET`

查询参数：

| 参数   | 说明                           |
| ------ | ------------------------------ |
| uid    | 用户id、int、必选              |
| config | 查询附加信息对象、object、必选 |

config 配置对象有如下属性：

|    属性    |  类型  |                     说明                     | 选择 |
| :--------: | :----: | :------------------------------------------: | :--: |
|   method   | string |     查询的类型、`person`，`group` 二选一     | 必选 |
| group_name | string | 团体名**关键字**，只能在`method=group`时使用 | 可选 |
|  category  | string |            借用器材类型**关键字**            | 可选 |
|    time    | string |            借用时间 ("%Y-%m-%d“)             | 可选 |
|   state    |  int   |        器材归还情况(0未归还、2已归还)        | 可选 |

```json
{
    "uid": 2135220,
    "config": {
        "method": "person"
    }
}

{
    "uid": 2135220,
    "config": {
        "method": "group"
    }
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |
| list   | 器材借用情况数组  |

```json 
// person
{
    "msg": "器材借用记录获取成功",
    "status": true,
    "list": [
        {
            "pic": "/media/images/equipment/20231118170904_73.png",
            "eid": 78184649,
            "category": "篮球",
            "lend_amount": 1,
            "start_time": "2023-12-12 19:00:00",
            "end_time": "2023-12-12 20:20:00",
            "is_return": "已归还"
        },
        {
            "pic": "/media/images/equipment/20231118171503_29.png",
            "eid": 2437271,
            "category": "网球",
            "lend_amount": 2,
            "start_time": "2023-11-27 12:00:00",
            "end_time": "2023-11-30 12:00:00",
            "is_return": "未归还"
        }
    ]
}

// group
{
    "msg": "器材借用记录获取成功",
    "status": true,
    "list": [
        {
            "gid": 36761710,
            "group_name": "大运村",
            "pic": "/media/images/equipment/20231118171107_100.png",
            "eid": 55695563,
            "category": "羽毛球",
            "lend_amount": 5,
            "start_time": "2023-11-30 12:00:00",
            "end_time": "2023-12-06 12:00:00",
            "is_return": "未归还"
        }
    ]
}
```



### 5.5 归还器材

> 说明：归还器材，其中团体允许其任何成员归还器材。
>
> 保证：用户存在、团体存在、器材存在；存在借用记录，且尚未归还。

请求 URL：`http://127.0.0.1:8000/api/equipment/return`

请求方式：`POST`

请求参数（application/json）：

| 参数       | 说明                                            |
| ---------- | ----------------------------------------------- |
| gid        | 团体id、int、可选                               |
| uid        | 用户id、int、可选                               |
| eid        | 器材id、int、必选                               |
| start_time | 借用开始时间、string("%Y-%m-%d %H:%M:%S")、必选 |
| end_time   | 借用结束时间、string("%Y-%m-%d %H:%M:%S")、必选 |

gid、uid 参数二选一，分别表示团体借用器材和用户借用器材两种情况。

```json
{
    "uid": 2135220,
    "eid": 78184649,
    "category": "篮球",
    "start_time": "2023-12-12 19:00:00",
    "end_time": "2023-12-12 20:20:00"
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "器材归还成功", 
    "status": true
}
```

<br>

## 六、好友相关

 ### 6.1 查看好友列表

> 说明：用户查看好友列表
>
> 保证：用户 uid 在数据库中。

请求 URL：`http://127.0.0.1:8000/api/friend/list`

请求方式：`GET`

查询参数：

| 参数    | 说明                       |
| ------- | -------------------------- |
| uid     | 用户id、int、必选          |
| keyword | 用户名关键字、string、可选 |

```json
{
    "uid": 2135220
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |
| list   | 好友数组、array   |

```json
{
    "msg": "好友列表请求成功",
    "status": true,
    "list": [
        {
            "uid": 31975929,
            "user_name": "杰少",
            "pic": "/media/images/user/20231128230108_95.jpg",
            "signature": "RAOS 创始人"
        }
    ]
}
```



### 6.2 搜索用户

> 说明：查找用户信息列表。
>
> 保证：用户 uid 在数据库中。

请求 URL：`http://127.0.0.1:8000/api/user/find`

请求方式：`GET`

查询参数：

| 参数    | 说明                       |
| ------- | -------------------------- |
| uid     | 用户id、int、必选          |
| keyword | 用户名关键字、string、必选 |

```json
{
    "uid": 2135220,
    "keyword": "小"
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |
| list   | 用户数组、array   |

```json
{
    "msg": "用户信息搜索成功",
    "status": true,
    "list": [
        {
            "uid": 30359251,
            "user_name": "小二",
            "pic": null,
            "signature": "无",
            "is_friend": false
        }
    ]
}
```



### 6.3 申请好友

> 说明：申请添加好友。
>
> 保证：数据库中存在对应实体；用户只能向非好友进行申请。
>
> 错误：审核时段申请则失败。

请求 URL：`http://127.0.0.1:8000/api/friend/add`

请求方式：`POST`

请求参数（application/json）：

| 参数     | 说明                   |
| -------- | ---------------------- |
| sender   | 发送者id、int、必选    |
| receiver | 接收者id、int、必选    |
| content  | 申请内容、string、必选 |

```json
{
    "sender": 2135220,
    "receiver": 30359251,
    "content": "添加好友"
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |

```json
{
    "msg": "申请信息已发送",
    "status": true
}
```



### 6.4 查看好友申请信息

> 说明：查看发送和接受到的好友申请信息。
>
> 保证：用户存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/friend/apply`

请求方式：`GET`

查询参数：

| 参数   | 说明                   |
| ------ | ---------------------- |
| uid    | 用户id、int、必选      |
| method | 申请类型、string、必选 |

method参数有两个选项：accept、send，分别表示查看收到和发送的申请。

```json
{
    "uid": 2135220,
    "method": "send"
}

{
    "uid": 30359251,
    "method": "accept"
}
```

返回响应：

| 数据   | 说明                |
| ------ | ------------------- |
| msg    | 返回说明、string    |
| status | 请求状态、boolean   |
| list   | 申请信息数组、array |

```json
/* method: send */
{
    "msg": "好友申请信息获取成功",
    "status": true,
    "list": [
        {
            "uid": 30359251,
            "user_name": "小二",
            "content": "添加好友",
            "status": "申请中",
            "time": "2023-11-24 15:03:12"
        }
    ]
}

/* method: accept */
{
    "msg": "好友申请信息获取成功",
    "status": true,
    "list": [
        {
            "uid": 2135220,
            "user_name": "贴吧第一美男子",
            "content": "添加好友",
            "status": "申请中",
            "time": "2023-11-24 15:03:12"
        }
    ]
}
```



### 6.5 处理好友申请

> 说明：用户处理自己的好友申请。
>
> 保证：相关实体存在于数据库中，保证申请信息存在。

请求 URL：`http://127.0.0.1:8000/api/friend/apply`

请求方式：`POST`

请求参数（application/json）：

| 参数     | 说明                                             |
| -------- | ------------------------------------------------ |
| receiver | 用户id、int、必选                                |
| sender   | 申请人id、int、必选                              |
| res      | 是否同意、boolean、必选、`true`同意，`false`拒绝 |

```json
{
    "receiver": 30359251,
    "sender": 2135220,
    "res": true
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "处理完成",
    "status": true
}
```



### 6.6 删除好友关系

> 说明：用户删除指定好友的联系。
>
> 保证：相关实体存在于数据库中，被删的联系存在于数据库中。

请求 URL：`http://127.0.0.1:8000/api/friend/delete`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |
| fid  | 好友id、int、必选 |

```json
{
    "uid": 2135220,
    "fid": 30359251
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "好友删除完成",
    "status": true
}
```

<br>

## 七、动态相关

### 7.1 用户发布动态

> 说明：用户基于已经参加的并且已经结束的活动发布动态感想。
>
> 保证：相关实体存在。

请求 URL：`http://127.0.0.1:8000/api/stream/publish`

请求方式：`POST`

请求参数（multipart/form-data）：

| 参数    | 说明                                                     |
| ------- | -------------------------------------------------------- |
| uid     | 用户id、int、必选                                        |
| text    | 动态文本、string、必选                                   |
| picture | 动态图片、file、可选                                     |
| private | 开放权限、int、必选（0自己可见、1朋友可见、2所有人可见） |
| aid     | 关联活动id、int、必选                                    |

```js
var data = new FormData();
data.append('uid', '31975929');
data.append('aid', '44709897');
data.append('text', '感谢大家支持！！！');
data.append('private', '2');
data.append('picture', null);
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "动态发布成功",
    "status": true
}
```



### 7.2 用户删除动态

> 说明：用户删除自己已经发布的动态。
>
> 保证：相关实体存在。

请求 URL：`http://127.0.0.1:8000/api/stream/delete`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| sid  | 动态id、int、必选 |

```json
{
    "sid": 87173257
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "动态删除成功",
    "status": true
}
```



### 7.3 查看动态列表

> 说明：用户查看对自己可见的所有动态.
>
> 保证：用户实体存在。

请求 URL：`http://127.0.0.1:8000/api/stream/view`

请求方式：`GET`

查询参数：

| 参数 | 说明                           |
| ---- | ------------------------------ |
| uid  | 用户id、int、必选              |
| time | 时间、string("%Y-%m-%d“)、可选 |

```json
{
    "uid": 30359251
}
```

返回响应：

| 数据   | 说明              |
| ------ | ----------------- |
| msg    | 返回说明、string  |
| status | 请求状态、boolean |
| list   | 动态数组、array   |

```json
{
  "msg": "动态列表获取成功",
  "status": true,
  "list": [
    {
      "own": false,
      "sid": 43980362,
      "time": "2023-12-05 10:24:35",
      "text": "感谢大家支持！！！",
      "picture": null,
      "favor": 1,
      "is_favor": false,
      "liker": [
        {
          "uid": 2135220,
          "user_name": "牧濑红莉栖"
        }
      ],
      "private": "所有人可见",
      "aid": 44709897,
      "activity_name": "RAOS 发布会"
    },
    {
      "own": true,
      "sid": 98200466,
      "time": "2023-12-05 10:19:43",
      "text": "RAOS真是令人激动而充满期待！从令人惊叹的产品展示到充满创意的演讲，整个活动令人难以忘怀。我深深感受到了团队的努力和创新精神，他们以出色的设计和技术带来了一款令人惊叹的产品。衷心希望RAOS能够越来越好。",
      "picture": null,
      "favor": 0,
      "is_favor": false,
      "liker": [],
      "private": "所有人可见",
      "aid": 44709897,
      "activity_name": "RAOS 发布会"
    }
  ]
}
```



### 7.4 点赞/取消

> 说明：用户可以给自己可见的动态点赞或撤销点赞。
>
> 保证：相关实体存在，用户只能在没有点赞时点赞，只能在点赞后取消点赞。

请求 URL：`http://127.0.0.1:8000/api/stream/favor`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |
| sid  | 动态id、int、必选 |

```json
{
    "uid": 2135220,
    "sid": 43980362
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |

```json
{
    "msg": "操作成功",
    "status": true
}
```

<br>

## 八、通知相关（未测试）

### 8.1 获取系统通知

> 说明：获取用户收到的系统通知信息。
>
> 保证：用户实体存在。

请求 URL：`http://127.0.0.1:8000/api/notice/list`

请求方式：`GET`

查询参数：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、必选 |

```json
{
    "uid": 
}
```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |
| list   | 通知数组、array  |

```json

```



### 8.2 确认通知

> 说明：用户确认收到的系统通知信息。
>
> 保证：相关实体存在。

请求 URL：`http://127.0.0.1:8000/api/notice/confirm`

请求方式：`POST`

请求参数（application/json）：

| 参数 | 说明              |
| ---- | ----------------- |
| uid  | 用户id、int、可选 |
| nid  | 通知id、int、可选 |

uid、nid二选一，前者表示用户确认所有通知，后者表示确认指定的通知。

```json

```

返回响应：

| 数据   | 说明             |
| ------ | ---------------- |
| msg    | 返回说明、string |
| status | 状态、boolean    |
